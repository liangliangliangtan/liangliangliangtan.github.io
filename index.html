<!DOCTYPE html>












  


<html class="theme-next pisces use-motion" lang="en">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
























<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/css/main.css?v=7.1.1">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.1.1">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.1.1">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.1.1">


  <link rel="mask-icon" href="/images/logo.svg?v=7.1.1" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '7.1.1',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false,"dimmer":false},
    back2top: true,
    back2top_sidebar: false,
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta property="og:type" content="website">
<meta property="og:title" content="Liang Tan&#39;s Blog">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Liang Tan&#39;s Blog">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Liang Tan&#39;s Blog">



  <link rel="alternate" href="/atom.xml" title="Liang Tan's Blog" type="application/atom+xml">



  
  
  <link rel="canonical" href="http://yoursite.com/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>Liang Tan's Blog</title>
  




  <script async src="//www.googletagmanager.com/gtag/js?id=UA-139580812-1"></script>
  <script>
    var host = window.location.hostname;
    if (host !== "localhost" || !true) {
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-139580812-1');
    }
  </script>









  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Liang Tan's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home menu-item-active">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>Home</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-about">

    
    
    
      
    

    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>About</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>Tags</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>Categories</a>

  </li>

      
      
    </ul>
  

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/05/14/neo4j-java-introduction/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Liang Tan">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/profile_photo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Liang Tan's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/05/14/neo4j-java-introduction/" class="post-title-link" itemprop="url">Introduction - how to use neo4j in java</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-05-14 13:14:38" itemprop="dateCreated datePublished" datetime="2019-05-14T13:14:38-06:00">2019-05-14</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-05-15 17:22:04" itemprop="dateModified" datetime="2019-05-15T17:22:04-06:00">2019-05-15</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/DB/" itemprop="url" rel="index"><span itemprop="name">DB</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="1-Introduction"><a href="#1-Introduction" class="headerlink" title="1. Introduction"></a>1. Introduction</h1><p>In this post, I will build a small web application in java by learning how to connect to as well as manipulate on neo4j database. Neo4j offers a rich set of integration possibilities for developers using Java or other JVM-languages. Following the instruction on the website, we will build a small web app for the movie database.</p>
<h1 id="2-Create-a-project-And-add-neo4j-driver-dependencies"><a href="#2-Create-a-project-And-add-neo4j-driver-dependencies" class="headerlink" title="2.Create a project And add neo4j driver dependencies"></a>2.Create a project And add neo4j driver dependencies</h1><p>Here, I use IntelliJ IDEA as dev tool and Maven as project management tool. So, select maven-archetype-webapp.</p>
<div><br>  <img src="/images/neo4j_java_1.png" alt="Smiley face" width="50%" height="50%"><br></div>

<p>After that, go to the maven repository website(<a href="https://mvnrepository.com/artifact/org.neo4j.app/neo4j-server/3.5.5" target="_blank" rel="noopener">Link</a>) and add dirver dependency to pom.xml.</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.neo4j.app<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>neo4j-server<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.neo4j.driver<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>neo4j-java-driver<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.7.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h1 id="3-Play-with-the-movie-dataSet"><a href="#3-Play-with-the-movie-dataSet" class="headerlink" title="3. Play with the movie dataSet."></a>3. Play with the movie dataSet.</h1><p>Using the data provided by the neo4j guides. Run all CQL commands and get the result.</p>
<p>Instruction from the guide</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">The Movie Graph is a mini graph application containing actors and directors that are related through the movies they&apos;ve collaborated on.</span><br><span class="line"></span><br><span class="line">This guide will show you how to:</span><br><span class="line"></span><br><span class="line">Create: insert movie data into the graph</span><br><span class="line">Find: retrieve individual movies and actors</span><br><span class="line">Query: discover related actors and directors</span><br><span class="line">Solve: the Bacon Path</span><br></pre></td></tr></table></figure>
<p>After executing the CQL languages, what we will get the graph database</p>
<div><br>  <img src="/images/neo4j_java_2.png" alt="Smiley face" width="50%" height="50%"><br></div>

<h1 id="4-Establish-Connection"><a href="#4-Establish-Connection" class="headerlink" title="4. Establish Connection."></a>4. Establish Connection.</h1><p>In order to use the diver, make connection to the neo4j database. we should do the following things.</p>
<ol>
<li>Provide a connection URL with username and password. The URL has the format: bolt://username:password@localhost</li>
<li>Get a driver instance</li>
<li>From the driver, create a session.</li>
<li><p>invoke session.run() method by parsing two parameters. 1). Cypher Query Language with parameters 2). Parameters given in the type of java map, with key-value pairs.</p>
</li>
<li><p>It will return result of Statement Result(<a href="https://neo4j.com/docs/api/java-driver/current/org/neo4j/driver/v1/StatementResult.html" target="_blank" rel="noopener">see Documantation for detail</a> ).It extends the Iterator class. so, it has hasNext() method and next() method to iterate through the result.</p>
</li>
<li><p>Close and session and close the database.</p>
</li>
</ol>
<p><strong>Cypher Query Language with parameters</strong> :</p>
<p>For Query String reuse and injection prevention. we will passing the parameters by Parameter Binding. In their document, they say:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Cypher supports querying with parameters. This means developers don&apos;t have to resort to string building to create a query. Additionally, parameters make caching of execution plans much easier for Cypher, thus leading to faster query execution times.</span><br></pre></td></tr></table></figure>
<p>Where to use.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Parameters can be used for:</span><br><span class="line"></span><br><span class="line">literals and expressions</span><br><span class="line">node and relationship ids</span><br><span class="line">for explicit indexes only: index values and queries</span><br></pre></td></tr></table></figure>
<p>Where cannot be used.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Parameters cannot be used for the following constructs, as these form part of the query structure that is compiled into a query plan:</span><br><span class="line">property keys; so, MATCH (n) WHERE n.$param = &apos;something&apos; is invalid</span><br><span class="line">relationship types</span><br><span class="line">labels</span><br></pre></td></tr></table></figure>
<p>There are multiple excellent Examples to use CQL With parameters in <a href="https://neo4j.com/docs/cypher-manual/3.5/syntax/parameters/" target="_blank" rel="noopener">neo4j documentation</a></p>
<p>Here, I wrote codes to test connection with Unit Test.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.neo4j.movies;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.neo4j.driver.v1.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EnvTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testConnection</span><span class="params">()</span></span>&#123;</span><br><span class="line">        Driver driver = GraphDatabase.driver( <span class="string">"bolt://localhost:7687"</span>, AuthTokens.basic(<span class="string">"neo4j"</span>, <span class="string">"root"</span> ) );</span><br><span class="line">        System.out.println(<span class="string">"Server is up and Running"</span>);</span><br><span class="line">        <span class="comment">// find all the author names for a given  movie name</span></span><br><span class="line">        String query = <span class="string">"MATCH (movie: Movie &#123;title:$title&#125;)&lt;-[:ACTED_IN]-(person:Person) RETURN person.name as actor"</span>;</span><br><span class="line">        Map&lt;String,Object&gt; titleMap = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        titleMap.put(<span class="string">"title"</span>,<span class="string">"The Matrix"</span>);</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            Session session = driver.session();</span><br><span class="line">            StatementResult statementResult = session.run(query,titleMap);</span><br><span class="line">            <span class="keyword">while</span>(statementResult.hasNext())&#123;</span><br><span class="line">                System.out.println(statementResult.next().get(<span class="string">"actor"</span>));</span><br><span class="line">            &#125;</span><br><span class="line">            session.close();</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            driver.close();</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Result</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">INFO: Direct driver instance 99451533 created for server address localhost:7687</span><br><span class="line">Server is up and Running</span><br><span class="line">&quot;Emil Eifrem&quot;</span><br><span class="line">&quot;Hugo Weaving&quot;</span><br><span class="line">&quot;Laurence Fishburne&quot;</span><br><span class="line">&quot;Carrie-Anne Moss&quot;</span><br><span class="line">&quot;Keanu Reeves&quot;</span><br><span class="line">May 14, 2019 3:45:49 PM org.neo4j.driver.internal.logging.JULogger info</span><br><span class="line">INFO: Closing driver instance 99451533</span><br><span class="line">May 14, 2019 3:45:49 PM org.neo4j.driver.internal.logging.JULogger info</span><br><span class="line">INFO: Closing connection pool towards localhost:7687</span><br><span class="line"></span><br><span class="line">Process finished with exit code 0</span><br></pre></td></tr></table></figure>
<p>Each Result is in the type of <strong><em>org.neo4j.driver.v1.Record</em></strong>, Record is a form of ordered map and, as such, contained values can be accessed by either positional index or textual key.<a href="https://neo4j.com/docs/api/java-driver/current/org/neo4j/driver/v1/Record.html" target="_blank" rel="noopener">doc</a>.</p>
<p>Record can either be node or relationships. When we retrieve data from the graph database, we either want to retrieve nodes(with properties and values) or a path contains nodes and relationships. Here are two small demos for retrieving nodes and paths.</p>
<h1 id="5-Small-Demo"><a href="#5-Small-Demo" class="headerlink" title="5. Small Demo"></a>5. Small Demo</h1><p>Preparation: Let us create a DriverUtil class to wrap the manipulations on the driver</p>
<h2 id="5-1-Retrieve-Node"><a href="#5-1-Retrieve-Node" class="headerlink" title="5.1 Retrieve Node."></a>5.1 Retrieve Node.</h2><p>Here is the sample code for querying a person by giving its name.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.neo4j.movies;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> Util.DriverUtil;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.neo4j.driver.v1.*;</span><br><span class="line"><span class="keyword">import</span> org.neo4j.driver.v1.types.Node;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.junit.Assert.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FindPersonByName</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">findPersonByName</span><span class="params">(String queryName)</span></span>&#123;</span><br><span class="line">        Driver driver = DriverUtil.getDriver();</span><br><span class="line">        String queryPersonByName = <span class="string">"MATCH (person:Person) WHERE person.name = $name RETURN person"</span>;</span><br><span class="line">        Map&lt;String,Object&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        map.put(<span class="string">"name"</span>,queryName);</span><br><span class="line">        <span class="keyword">try</span>(Session session = driver.session()) &#123;</span><br><span class="line">            StatementResult statementResult  = session.run(queryPersonByName, map);</span><br><span class="line">            <span class="keyword">while</span>(statementResult.hasNext())&#123;</span><br><span class="line">                Record record = statementResult.next();</span><br><span class="line">                List&lt;Value&gt; valueList = record.values();<span class="comment">// Retrieve the values of the underlying map</span></span><br><span class="line">                assertEquals(valueList.size(),<span class="number">1</span>);</span><br><span class="line">                <span class="comment">// each value is a node actually, so convert to node type</span></span><br><span class="line">                <span class="keyword">for</span>(Value value: valueList)&#123;</span><br><span class="line">                    Node node = value.asNode();</span><br><span class="line">                    <span class="comment">// iterate through node labels</span></span><br><span class="line">                    Iterator&lt;String&gt; labels = node.labels().iterator();</span><br><span class="line">                    System.out.println(<span class="string">"Node labels"</span>);</span><br><span class="line">                    <span class="keyword">while</span>(labels.hasNext())&#123;</span><br><span class="line">                        System.out.println(labels.next());</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="comment">// iterate through node property-value pairs</span></span><br><span class="line">                    System.out.println(<span class="string">"Node key-value pairs "</span>);</span><br><span class="line">                    Iterator&lt;String&gt; keys = node.keys().iterator();</span><br><span class="line">                    <span class="keyword">while</span>(keys.hasNext())&#123;</span><br><span class="line">                        String property = keys.next();</span><br><span class="line">                        Object propertyValue = node.get(property);</span><br><span class="line">                        System.out.println(<span class="string">"property: "</span>+ property);</span><br><span class="line">                        System.out.println(<span class="string">"propertyValue: "</span>+ propertyValue);</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            DriverUtil.closeDriver();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        FindPersonByName fd = <span class="keyword">new</span> findPersonByName();</span><br><span class="line">        fd.findPersonByName(<span class="string">"Emil Eifrem"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Result</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">INFO: Direct driver instance 530653666 created for server address localhost:7687</span><br><span class="line">Node labels</span><br><span class="line">Person</span><br><span class="line"></span><br><span class="line">Node key-value pairs</span><br><span class="line">property: name</span><br><span class="line">propertyValue: &quot;Emil Eifrem&quot;</span><br><span class="line">property: born</span><br><span class="line">propertyValue: 1978</span><br><span class="line"></span><br><span class="line">INFO: Closing connection pool towards localhost:7687</span><br><span class="line">Disconnected from the target VM, address: &apos;127.0.0.1:57996&apos;, transport: &apos;socket&apos;</span><br><span class="line"></span><br><span class="line">Process finished with exit code 0</span><br></pre></td></tr></table></figure>
<p>We can see the Result Object by debugging mode.</p>
<div><br>  <img src="/images/neo4j_java_3.png" alt="Smiley face" width="50%" height="50%"><br></div>

<p>We can see that Record itself is an unordered Hash Map, and keys are the Strings of the Return Statement in SQL. And the Value object itself is also a HashMap.</p>
<p>If value itself is a node. it contains</p>
<ol>
<li>A List of labels</li>
<li>A List of properties, where properties itself is also a hash map, mapping from property keys to property values.</li>
</ol>
<p>For all their usages ,see <a href="https://neo4j.com/docs/api/java-driver/current/org/neo4j/driver/v1/types/MapAccessor.html" target="_blank" rel="noopener">document</a>.</p>
<h2 id="5-2-Retrieve-Path-relationship"><a href="#5-2-Retrieve-Path-relationship" class="headerlink" title="5.2 Retrieve Path(relationship)."></a>5.2 Retrieve Path(relationship).</h2><p>Suppose we want to see if a person ACTED_IN a movie and what is his/her role in the movie. If that particular people does not ACTED_IN that movie, return false.</p>
<p>e.g “Keanu Reeves” ACTED_IN “Johnny Mnemonic” as “Johnny Mnemonic”</p>
<div><br>  <img src="/images/neo4j_java_4.png" alt="Smiley face" width="50%" height="50%"><br></div>

<p>Lets see the path Object.</p>
<p>It contains:</p>
<ol>
<li>An ArrayList of nodes</li>
<li>An ArrayList of relationships</li>
<li>An ArrayList of segments which contains the start node, relation and the end node.</li>
</ol>
<div><br>  <img src="/images/neo4j_java_5.png" alt="Smiley face" width="50%" height="50%"><br></div>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.neo4j.movies;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> Util.DriverUtil;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.neo4j.driver.v1.*;</span><br><span class="line"><span class="keyword">import</span> org.neo4j.driver.v1.types.Node;</span><br><span class="line"><span class="keyword">import</span> org.neo4j.driver.v1.types.Path;</span><br><span class="line"><span class="keyword">import</span> org.neo4j.driver.v1.types.Relationship;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FindRolesByPersonNameAndMovieName</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">findRolesByPersonNameAndMovieName</span><span class="params">(String actorName, String movieName)</span></span>&#123;</span><br><span class="line">        Driver driver = DriverUtil.getDriver();</span><br><span class="line">        String queryRoles = <span class="string">"MATCH p =(person:Person)-[ACTED_IN]-&gt;(movie:Movie) WHERE person.name = $actorName "</span> +</span><br><span class="line">                                    <span class="string">"AND movie.title = $movieName RETURN p "</span>;</span><br><span class="line">        Map&lt;String,Object&gt; parameters = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        parameters.put(<span class="string">"actorName"</span>,actorName);</span><br><span class="line">        parameters.put(<span class="string">"movieName"</span>,movieName);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>(Session session = driver.session())&#123;</span><br><span class="line">            StatementResult statementResult  = session.run(queryRoles,parameters);</span><br><span class="line">            System.out.println(<span class="string">"*****relationship*******"</span>);</span><br><span class="line">            <span class="keyword">while</span>(statementResult.hasNext())&#123;</span><br><span class="line">                Record record = statementResult.next();</span><br><span class="line">                List&lt;Value&gt; valuesList = record.values();</span><br><span class="line">                <span class="comment">// if the movie and actor do not match each other, no searching result.</span></span><br><span class="line">                <span class="keyword">if</span>(valuesList == <span class="keyword">null</span> || valuesList.size() == <span class="number">0</span>) <span class="keyword">return</span>;</span><br><span class="line">                <span class="comment">// find the relationship between the movie node and person node</span></span><br><span class="line">                Path path = valuesList.get(<span class="number">0</span>).asPath();</span><br><span class="line">                <span class="comment">// find all the relationships(edges) along the path</span></span><br><span class="line">                Iterator&lt;Relationship&gt; relationships = path.relationships().iterator();</span><br><span class="line">                <span class="comment">// find all the nodes along the path</span></span><br><span class="line">                Iterator&lt;Node&gt; nodes = path.nodes().iterator();</span><br><span class="line">                <span class="comment">// iterate edges along the path</span></span><br><span class="line">                <span class="keyword">while</span>(relationships.hasNext())&#123;</span><br><span class="line">                    Relationship relationship = relationships.next();</span><br><span class="line">                    relationship.startNodeId();</span><br><span class="line">                    relationship.endNodeId();</span><br><span class="line">                    String relationType = relationship.type();</span><br><span class="line">                    System.out.println(<span class="string">"start from Node Id: "</span>+ relationship.startNodeId());</span><br><span class="line">                    System.out.println(<span class="string">"end from Node Id: "</span>+ relationship.endNodeId());</span><br><span class="line">                    System.out.println(<span class="string">"The relation type is:"</span> +relationType);</span><br><span class="line">                    System.out.println(<span class="string">"RelationShip key value pairs"</span>);</span><br><span class="line">                    Iterator&lt;String&gt; relationKeys = relationship.keys().iterator();</span><br><span class="line">                    <span class="keyword">while</span>(relationKeys.hasNext())&#123;</span><br><span class="line">                        String relationKey = relationKeys.next();</span><br><span class="line">                        Object relationValue = relationship.get(relationKey).get(<span class="number">0</span>);</span><br><span class="line">                        System.out.println(relationKey +<span class="string">":"</span> +relationValue);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="comment">// iterate all nodes along the path</span></span><br><span class="line">                <span class="keyword">while</span>(nodes.hasNext())&#123;</span><br><span class="line">                    System.out.println(<span class="string">"*****Node*******"</span>);</span><br><span class="line">                    Node node = nodes.next();</span><br><span class="line">                    System.out.println(<span class="string">"Node Id: "</span> + node.id());</span><br><span class="line">                    Iterator&lt;String&gt; labels = node.labels().iterator();</span><br><span class="line">                    System.out.println(<span class="string">"Node labels"</span>);</span><br><span class="line">                    <span class="keyword">while</span>(labels.hasNext())&#123;</span><br><span class="line">                        System.out.println(labels.next());</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="comment">// iterate through node property-value pairs</span></span><br><span class="line">                    System.out.println(<span class="string">"Node key-value pairs "</span>);</span><br><span class="line">                    Iterator&lt;String&gt; keys = node.keys().iterator();</span><br><span class="line">                    <span class="keyword">while</span>(keys.hasNext())&#123;</span><br><span class="line">                        String property = keys.next();</span><br><span class="line">                        Object propertyValue = node.get(property);</span><br><span class="line">                        System.out.println(property+<span class="string">":"</span>+propertyValue);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            DriverUtil.closeDriver();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        FindRolesByPersonNameAndMovieName findRole = <span class="keyword">new</span> FindRolesByPersonNameAndMovieName();</span><br><span class="line">        findRole.findRolesByPersonNameAndMovieName(<span class="string">"Keanu Reeves"</span>,<span class="string">"Johnny Mnemonic"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Result</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">*****relationship*******</span><br><span class="line">start from Node Id: 1</span><br><span class="line">end from Node Id: 161</span><br><span class="line">The relation type is:ACTED_IN</span><br><span class="line">RelationShip key value pairs</span><br><span class="line">roles:&quot;Johnny Mnemonic&quot;</span><br><span class="line">*****Node*******</span><br><span class="line">Node Id: 1</span><br><span class="line">Node labels</span><br><span class="line">Person</span><br><span class="line">Node key-value pairs</span><br><span class="line">name:&quot;Keanu Reeves&quot;</span><br><span class="line">born:1964</span><br><span class="line">*****Node*******</span><br><span class="line">Node Id: 161</span><br><span class="line">Node labels</span><br><span class="line">Movie</span><br><span class="line">Node key-value pairs</span><br><span class="line">tagline:&quot;The hottest data on earth. In the coolest head in town&quot;</span><br><span class="line">title:&quot;Johnny Mnemonic&quot;</span><br><span class="line">released:1995</span><br></pre></td></tr></table></figure>
<p>Notice that: the return type is a path, So, in CQL, We name the path as p. If we want to return all, Using Return *, see CQL manual,<a href="https://neo4j.com/docs/cypher-manual/current/clauses/return" target="_blank" rel="noopener">link</a>.</p>
<h2 id="6-ORM-Mapping-And-Mapping-to-JSON"><a href="#6-ORM-Mapping-And-Mapping-to-JSON" class="headerlink" title="6. ORM Mapping And Mapping to JSON"></a>6. ORM Mapping And Mapping to JSON</h2><p>To be continued.</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/05/13/online-shopping-project-db-design/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Liang Tan">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/profile_photo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Liang Tan's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/05/13/online-shopping-project-db-design/" class="post-title-link" itemprop="url">How to Design your Own Online Shopping Website like amazon -- DB design</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-05-13 19:40:19" itemprop="dateCreated datePublished" datetime="2019-05-13T19:40:19-06:00">2019-05-13</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-05-14 11:23:03" itemprop="dateModified" datetime="2019-05-14T11:23:03-06:00">2019-05-14</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/MySQL-DB/" itemprop="url" rel="index"><span itemprop="name">MySQL DB</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="1-Introduction"><a href="#1-Introduction" class="headerlink" title="1. Introduction"></a>1. Introduction</h1><p>Before designing the database for our small online shopping system, let’s review three normalization forms.</p>
<ol>
<li><strong>1NF:</strong> remove repeated/ redundant data</li>
<li><strong>2NF:</strong> make sure that all the fields in the table are dependent <strong>only</strong> on primary key.</li>
<li><strong>3NF:</strong> remove <strong>calculated(transitive)</strong> fields</li>
</ol>
<p>Now let us discuss about the important entities in this system.</p>
<p>1.In the first place, we must have users.</p>
<table>
<thead>
<tr>
<th>Field(Attribute)</th>
<th>Explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td>user_id</td>
<td>unique primary key for each user</td>
</tr>
<tr>
<td>user_name</td>
<td>user’s name</td>
</tr>
<tr>
<td>user_password</td>
<td>password for each user</td>
</tr>
</tbody>
</table>
<p>2.There must be multiple product categories.</p>
<table>
<thead>
<tr>
<th>Field(Attribute)</th>
<th>Explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td>category_id</td>
<td>unique primary key for each product category</td>
</tr>
<tr>
<td>category_name</td>
<td>product category name</td>
</tr>
</tbody>
</table>
<p>3.Then,there should be <strong>multiple products in one category</strong>, and <strong>each product should be in only one category</strong>.(For some scenario, it could be in multiple category). At the same time, one <strong>one category should have many combinations of properties</strong>.(For example, laptops have properties like, CPU, Memory, Grapics,etc).SO, there is a <strong>many-to-many relationships between properties and products</strong>. therefore, we should create a table to store the relationship between them to satisfy the 3NF forms. Hence, we could design a table called property_value. One property has multiple property values and one product has many property values as well.</p>
<table>
<thead>
<tr>
<th>Field(Attribute)</th>
<th>Explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td>property_id</td>
<td>unique primary key for each property</td>
</tr>
<tr>
<td>property_category_id</td>
<td>foreign key from category table</td>
</tr>
<tr>
<td>property_name</td>
<td>name of each property</td>
</tr>
</tbody>
</table>
<p>Product Table</p>
<table>
<thead>
<tr>
<th>Field(Attribute)</th>
<th>Explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td>product_id</td>
<td>product_id</td>
</tr>
<tr>
<td>product_subtitle</td>
<td>subtitle for products</td>
</tr>
<tr>
<td>original_price</td>
<td></td>
</tr>
<tr>
<td>promote_price</td>
<td></td>
</tr>
<tr>
<td>create_time</td>
<td>on sale time</td>
</tr>
</tbody>
</table>
<p>Property Value Table (Relationships)</p>
<table>
<thead>
<tr>
<th>Field(Attribute)</th>
<th>Explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>property Value primary key</td>
</tr>
<tr>
<td>property_id</td>
<td>foreign key product_id</td>
</tr>
<tr>
<td>product_id</td>
<td>foreign key product_id</td>
</tr>
<tr>
<td>propertye_value</td>
<td></td>
</tr>
<tr>
<td>promote_price</td>
<td></td>
</tr>
<tr>
<td>create_time</td>
<td>on sale time</td>
</tr>
</tbody>
</table>
<p>Each product has many product image to be shown, therefore, we could create a table to store product images</p>
<table>
<thead>
<tr>
<th>Field(Attribute)</th>
<th>Explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td>product_image_id</td>
<td>product_id</td>
</tr>
<tr>
<td>product_id</td>
<td>foreign key constraints for product id</td>
</tr>
<tr>
<td>image_type</td>
<td>indicating whether it is details figure and display image</td>
</tr>
</tbody>
</table>
<p>For product reviews, one product has many reviews and each user can post many reviews. Therefore, reviews table has two foreign key constraints</p>
<table>
<thead>
<tr>
<th>Field(Attribute)</th>
<th>Explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td>review_id</td>
<td>primary key</td>
</tr>
<tr>
<td>review_content</td>
<td>content for review in varchar type</td>
</tr>
<tr>
<td>user_id</td>
<td>foreign key constraints for user id</td>
</tr>
<tr>
<td>product_id</td>
<td>foreign key constraints for product id</td>
</tr>
<tr>
<td>create_date</td>
<td>review generated date</td>
</tr>
</tbody>
</table>
<p>Finally, the most important thing is the order and the ordered item.</p>
<table>
<thead>
<tr>
<th>Field(Attribute)</th>
<th>Explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td>order_id</td>
<td>primary key</td>
</tr>
<tr>
<td>order_code</td>
<td>unique order code</td>
</tr>
<tr>
<td>order_address</td>
<td>order_address</td>
</tr>
<tr>
<td>order_receiver</td>
<td>order_receiver</td>
</tr>
<tr>
<td>order_mobile</td>
<td>order_mobile number</td>
</tr>
<tr>
<td>order_user_message</td>
<td>order_user_message</td>
</tr>
<tr>
<td>create_date</td>
<td>create_date</td>
</tr>
<tr>
<td>pay_date</td>
<td>pay_date</td>
</tr>
<tr>
<td>delivery_date</td>
<td>delivery_date</td>
</tr>
<tr>
<td>confirmDate</td>
<td>confirmDate</td>
</tr>
<tr>
<td>order_status</td>
<td>order_status</td>
</tr>
<tr>
<td>user_id:</td>
<td>FOREIGN KEY constraints</td>
</tr>
</tbody>
</table>
<p>user table</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="keyword">user</span> (</span><br><span class="line">  user_id <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  user_name <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  user_password <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (user_id)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8;</span><br></pre></td></tr></table></figure>
<p>category table</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="keyword">category</span> (</span><br><span class="line">  category_id <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  category_name <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (category_id)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span>  <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8;</span><br></pre></td></tr></table></figure>
<p>property table</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> property (</span><br><span class="line">  property_id <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  category_id <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  property_name <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (property_id),</span><br><span class="line">  <span class="keyword">CONSTRAINT</span> fk_property_category <span class="keyword">FOREIGN</span> <span class="keyword">KEY</span> (category_id) <span class="keyword">REFERENCES</span> <span class="keyword">category</span> (category_id)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8;</span><br></pre></td></tr></table></figure>
<p>product_table</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> product (</span><br><span class="line">  product_id <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  product_name <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  product_subtitle <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  original_price <span class="built_in">float</span> <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  promote_price <span class="built_in">float</span> <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  stock <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  category_id <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  create_date datetime <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (product_id),</span><br><span class="line">  <span class="keyword">CONSTRAINT</span> fk_product_category <span class="keyword">FOREIGN</span> <span class="keyword">KEY</span> (category_id) <span class="keyword">REFERENCES</span> <span class="keyword">category</span> (category_id)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span>  <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8;</span><br></pre></td></tr></table></figure>
<p>property value table</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> property_value (</span><br><span class="line">  property_value_id <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  product_id <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  property_id <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  property_value <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (property_value_id),</span><br><span class="line">  <span class="keyword">CONSTRAINT</span> fk_propertyvalue_property <span class="keyword">FOREIGN</span> <span class="keyword">KEY</span> (property_id) <span class="keyword">REFERENCES</span> property (property_id),</span><br><span class="line">  <span class="keyword">CONSTRAINT</span> fk_propertyvalue_product <span class="keyword">FOREIGN</span> <span class="keyword">KEY</span> (product_id) <span class="keyword">REFERENCES</span> product (product_id)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span>  <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8;</span><br></pre></td></tr></table></figure>
<p>product iamge table</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> product_image (</span><br><span class="line">  product_image_id <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  product_id <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  product_image_type <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (product_image_id),</span><br><span class="line">  <span class="keyword">CONSTRAINT</span> fk_productimage_product <span class="keyword">FOREIGN</span> <span class="keyword">KEY</span> (product_id) <span class="keyword">REFERENCES</span> product (product_id)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8;</span><br></pre></td></tr></table></figure>
<p>review table</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> review (</span><br><span class="line">  review_id <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  review_content <span class="built_in">varchar</span>(<span class="number">4000</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  user_id <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  product_id <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  create_date datetime <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (review_id),</span><br><span class="line">  <span class="keyword">CONSTRAINT</span> fk_review_product <span class="keyword">FOREIGN</span> <span class="keyword">KEY</span> (product_id) <span class="keyword">REFERENCES</span> product (product_id),</span><br><span class="line">  <span class="keyword">CONSTRAINT</span> fk_review_user <span class="keyword">FOREIGN</span> <span class="keyword">KEY</span> (user_id) <span class="keyword">REFERENCES</span> <span class="keyword">user</span> (user_id)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span>  <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8;</span><br></pre></td></tr></table></figure>
<p>Order table</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> order_ (</span><br><span class="line">  order_id <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  order_code <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  order_address <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  order_post <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  order_receiver <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  order_mobile <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  order_user_message <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  create_date datetime <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  pay_date datetime <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  delivery_date datetime <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  confirm_date datetime <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  user_id <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  order_status <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (order_id),</span><br><span class="line">  <span class="keyword">CONSTRAINT</span> fk_order_user <span class="keyword">FOREIGN</span> <span class="keyword">KEY</span> (user_id) <span class="keyword">REFERENCES</span> <span class="keyword">user</span> (user_id)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span>  <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8;</span><br></pre></td></tr></table></figure>
<p>order_item table</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> order_item (</span><br><span class="line">  order_item_id <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  product_id <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  order_id <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  user_id <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  order_item_number <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (order_item_id),</span><br><span class="line">  <span class="keyword">CONSTRAINT</span> fk_orderitem_user <span class="keyword">FOREIGN</span> <span class="keyword">KEY</span> (user_id) <span class="keyword">REFERENCES</span> <span class="keyword">user</span> (user_id),</span><br><span class="line">  <span class="keyword">CONSTRAINT</span> fk_orderitem_product <span class="keyword">FOREIGN</span> <span class="keyword">KEY</span> (product_id) <span class="keyword">REFERENCES</span> product (product_id),</span><br><span class="line">  <span class="keyword">CONSTRAINT</span> fk_orderitem_order <span class="keyword">FOREIGN</span> <span class="keyword">KEY</span> (order_id) <span class="keyword">REFERENCES</span> order_ (order_id)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span>  <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8;</span><br></pre></td></tr></table></figure>
<p>Generate the E-R diagram by MySQL WORKBENCH.</p>
<div><br>  <img src="/images/db_er_figure.png" alt="Smiley face" width="50%" height="50%"><br>  <div class="text" style="text-align:center;font-size:10px"> ER diagram by MySQL</div><br></div>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/05/13/online-shopping-project-software-Requirment-Analysis/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Liang Tan">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/profile_photo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Liang Tan's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/05/13/online-shopping-project-software-Requirment-Analysis/" class="post-title-link" itemprop="url">How to Design your Own Online Shopping Website like amazon -- Requirements Analysis</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-05-13 16:54:45" itemprop="dateCreated datePublished" datetime="2019-05-13T16:54:45-06:00">2019-05-13</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-05-14 10:58:58" itemprop="dateModified" datetime="2019-05-14T10:58:58-06:00">2019-05-14</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a></span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Java/MySQL/" itemprop="url" rel="index"><span itemprop="name">MySQL</span></a></span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Java/MySQL/Javascript/" itemprop="url" rel="index"><span itemprop="name">Javascript</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Basically, for design an website, we mainly have 4 parts.</p>
<ol>
<li><p>Front-End display: This part is mainly about how to display the data in MySQL database, like the index page, detailed products pages, shopping carts pages and shopping categories pages.</p>
</li>
<li><p>Interaction Between Front-End and Back-End: When the clients or the admin have a serial of actions like buying a product, add a product to their shopping carts, log in and log out to the web site. This part is how you design controllers and tiny URL BY Using HTTP protocol (e.g GET and POST Method).</p>
</li>
<li><p>Back-end Management : This part is to maintain the data used in the website, like the product managements, products picture managements, user managements ,order managements ,so on and so forth.</p>
</li>
<li><p>Databases and Entities Design. In this part, we will carefully design the schema of our MySQL database. We will create the schema for each table and establish the relationships between tables. Based on those tables, we will create the classes mapping to tables.</p>
</li>
</ol>
<p>I will go deep into requirements analysis for each part in another blog.</p>
<p>Here, I will list all the tech stacks used in this project.</p>
<table>
<thead>
<tr>
<th>Database</th>
<th>MySQL</th>
</tr>
</thead>
<tbody>
<tr>
<td>server-side template engine</td>
<td>Java Server Page(JSP)</td>
</tr>
<tr>
<td>Front-End FrameWork</td>
<td>Bootstrap, JQuery</td>
</tr>
<tr>
<td>Communication between Front-end and Back-end</td>
<td>AJAX(In JSON data type)</td>
</tr>
<tr>
<td>Project Management Tool</td>
<td>Maven</td>
</tr>
<tr>
<td>Database Aceess</td>
<td>Mybatis</td>
</tr>
<tr>
<td>Web Container</td>
<td>Tomcat</td>
</tr>
<tr>
<td>Web Architecture</td>
<td>Spring MVC</td>
</tr>
<tr>
<td>Dev tools</td>
<td>IntelliJ IDEA</td>
</tr>
</tbody>
</table>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/05/13/CRUD-neo4j/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Liang Tan">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/profile_photo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Liang Tan's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/05/13/CRUD-neo4j/" class="post-title-link" itemprop="url">Introduction to CRUD operations in Neo4j</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-05-13 10:20:32 / Modified: 16:56:29" itemprop="dateCreated datePublished" datetime="2019-05-13T10:20:32-06:00">2019-05-13</time>
            

            
              

              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/DB/" itemprop="url" rel="index"><span itemprop="name">DB</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="1-Introduction"><a href="#1-Introduction" class="headerlink" title="1. Introduction:"></a>1. Introduction:</h2><p>In this section, we are going to learn and summarize the most recent used CRUD operations in Neo4j.We are going to use SET, Remove, Delete and Merge(Create and MATCH) clause.</p>
<h2 id="2-Merge-Command"><a href="#2-Merge-Command" class="headerlink" title="2 Merge Command"></a>2 Merge Command</h2><p>Merge commend is used to either create a node with labels or properties if the node does not exist in the database or select the nodes with particular conditions if the nodes are already presents in the database.</p>
<h3 id="2-1-Using-Merge-command-with-labels-and-properties"><a href="#2-1-Using-Merge-command-with-labels-and-properties" class="headerlink" title="2.1 Using Merge command with labels and properties."></a>2.1 Using Merge command with labels and properties.</h3><p>Example<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ Merge(Jeson:Man) <span class="built_in">return</span> Jeson, labels(Jeson)</span><br></pre></td></tr></table></figure></p>
<p>Since it does not exists in the database, it will create a new node and a new label Man and return the node and labels of that specific node.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ Merge(Jack:Man&#123;Name:<span class="string">"Jack"</span>,Gender:<span class="string">"male"</span>&#125;) <span class="built_in">return</span> Jack</span><br></pre></td></tr></table></figure>
<p>When running this merge command, it will firstly look at if there exists a node jack with corresponding key-value pairs, if it does not exits, it will create a new node and return the node.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ Merge(Jack:Man&#123;Name:<span class="string">"Jack"</span>,Age:<span class="string">"30"</span>&#125;) <span class="built_in">return</span> Jack</span><br></pre></td></tr></table></figure>
<p>It will seperately create a node with the same name as before but differnt properties.<br>Then, if we run the following comand<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ Merge(Man&#123;Name:<span class="string">"Jack"</span>&#125;) <span class="built_in">return</span> Man.Name, Man.Gender, Man.Age</span><br></pre></td></tr></table></figure></p>
<p>It will find all the nodes with name Jack and label Man, and the properties related to jack</p>
<div><br>  <img src="/images/neo4j_intro_crud1.png" alt="Smiley face" width="50%" height="50%"><br></div>

<h3 id="2-2-Using-Merge-command-to-create-Node-with-existing-node-properties"><a href="#2-2-Using-Merge-command-to-create-Node-with-existing-node-properties" class="headerlink" title="2.2 Using Merge command to create Node with existing node properties."></a>2.2 Using Merge command to create Node with existing node properties.</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">MATCH (n) WHERE EXISTS(n.Gender)</span><br><span class="line">Merge (gender:Gender&#123;Gender:n.Gender&#125;)</span><br><span class="line"><span class="built_in">return</span> gender</span><br></pre></td></tr></table></figure>
<div><br>  <img src="/images/neo4j_intro_crud2.png" alt="Smiley face" width="50%" height="50%"><br></div>

<p>We could see that we have created all gender with matching all the nodes with Gender properties.  </p>
<h3 id="2-3-Merge-command-with-on-create-clause"><a href="#2-3-Merge-command-with-on-create-clause" class="headerlink" title="2.3 Merge command with on create clause."></a>2.3 Merge command with on create clause.</h3><p>When creating a new node, we would like to set the properties for this node at the same time, ON CREATE clause will allows the user to set properties at creation time.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Merge (Yuki:Person&#123;Name:<span class="string">"Yuki"</span>&#125;)</span><br><span class="line">ON CREATE SET Yuki.Gender = <span class="string">"Female"</span></span><br><span class="line">RETURN Yuki.Name,Yuki.Gender</span><br></pre></td></tr></table></figure>
<div><br>  <img src="/images/neo4j_intro_crud3.png" alt="Smiley face" width="50%" height="50%"><br></div>

<h3 id="2-4-Merge-command-with-on-match-clause"><a href="#2-4-Merge-command-with-on-match-clause" class="headerlink" title="2.4 Merge command with on match clause."></a>2.4 Merge command with on match clause.</h3><p>When traversing from the graph database to find some nodes with some conditions, we need to set some properties to those node at the same time for updating the information regarding to this node.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Merge (person:Person)</span><br><span class="line">ON MATCH SET person.Is_Person = TRUE</span><br><span class="line">RETURN person.Name, person.Is_Person</span><br></pre></td></tr></table></figure>
<p>Using merge command we could find all the node with label Person and add a new property Is_Person to be true</p>
<div><br>  <img src="/images/neo4j_intro_crud4.png" alt="Smiley face" width="50%" height="50%"><br></div>

<h3 id="2-4-Merge-command-for-relationships"><a href="#2-4-Merge-command-for-relationships" class="headerlink" title="2.4 Merge command for relationships"></a>2.4 Merge command for relationships</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Merge (mika:Person&#123;Name:<span class="string">"mika"</span>&#125;)</span><br><span class="line">ON CREATE SET mika.Gender = <span class="string">"Male"</span></span><br><span class="line">RETURN mika.Name,mika.Gender</span><br></pre></td></tr></table></figure>
<p>Suppose Yuki has a boyfriend mika. we want to create relationships between them.We could run the following commands<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">MATCH (girl:Person),(boy:Person)</span><br><span class="line">WHERE girl.Name = <span class="string">"Yuki"</span> AND boy.Name = <span class="string">"mika"</span></span><br><span class="line">MERGE (girl)-[relationship:Has_A_Boy_Friend]-&gt;(boy)</span><br><span class="line">RETURN girl,boy</span><br></pre></td></tr></table></figure></p>
<div><br>  <img src="/images/neo4j_intro_crud5.png" alt="Smiley face" width="50%" height="50%"><br></div>


<h2 id="3-SET-Command"><a href="#3-SET-Command" class="headerlink" title="3 SET Command"></a>3 SET Command</h2><p>SET Clause is to set and remove properties of nodes. If Yuki goes to Tokyo University, we could run the following command. We could use set clause to add school properties to Yuki, and remove the Is_Person property we have set before.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">MATCH (Yuki:Person)</span><br><span class="line">WHERE Yuki.Name = <span class="string">"Yuki"</span></span><br><span class="line">SET Yuki.School = <span class="string">"Tokyo University"</span></span><br><span class="line">SET Yuki.Is_Person = NULL</span><br><span class="line">RETURN Yuki</span><br></pre></td></tr></table></figure></p>
<div><br>  <img src="/images/neo4j_intro_crud6.png" alt="Smiley face" width="50%" height="50%"><br></div>

<p>We could also use SET Clause to set multiple labels for some nodes,e.g,add two labels to Yuki which are Student and Gril.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">MATCH (Yuki:Person)</span><br><span class="line">WHERE Yuki.Name = <span class="string">"Yuki"</span></span><br><span class="line">SET Yuki:Student:Gril</span><br><span class="line">RETURN Yuki</span><br></pre></td></tr></table></figure></p>
<div><br>  <img src="/images/neo4j_intro_crud7.png" alt="Smiley face" width="50%" height="50%"><br></div>


<h2 id="4-DELETE-Command"><a href="#4-DELETE-Command" class="headerlink" title="4 DELETE Command"></a>4 DELETE Command</h2><p>DELETE command is to delete specific nodes or relationships between nodes. Here we will learn some of the basic usage of delete clause in CQL.</p>
<h3 id="4-1-DELETE-ALL-NODES"><a href="#4-1-DELETE-ALL-NODES" class="headerlink" title="4.1 DELETE ALL NODES"></a>4.1 DELETE ALL NODES</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MATCH (node)</span><br><span class="line">DETACH DELETE node</span><br></pre></td></tr></table></figure>
<p>DETACH is to firstly delete the relationships between the nodes that we are going to delete.</p>
<h3 id="4-2-DELETE-GROUPS-OF-NODES-WITH-CONDITIONS"><a href="#4-2-DELETE-GROUPS-OF-NODES-WITH-CONDITIONS" class="headerlink" title="4.2 DELETE GROUPS OF NODES WITH CONDITIONS"></a>4.2 DELETE GROUPS OF NODES WITH CONDITIONS</h3><p>It is quite similar but still notice that when deleting a node, we should delete the relationships first.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">MATCH (mika:Person)</span><br><span class="line">WHERE mika.Name = <span class="string">"mika"</span></span><br><span class="line">DETACH DELETE mika</span><br></pre></td></tr></table></figure></p>
<p>Next,  I will go through an example to have a overall understanding of CRUD By SQL.</p>
<p>TO BE CONTINUED</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/05/09/neo4j-1-introducion/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Liang Tan">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/profile_photo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Liang Tan's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/05/09/neo4j-1-introducion/" class="post-title-link" itemprop="url">neo4j_1_introducion</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-05-09 09:43:20 / Modified: 17:35:23" itemprop="dateCreated datePublished" datetime="2019-05-09T09:43:20-06:00">2019-05-09</time>
            

            
              

              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/DB/" itemprop="url" rel="index"><span itemprop="name">DB</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="1-Download-and-installation"><a href="#1-Download-and-installation" class="headerlink" title="1. Download and installation"></a>1. Download and installation</h2><p>Neo4j is a very popular, widely-used No-SQL graph database. Let us first try to download and install neo4j on our own laptop. Go to their official webpages, and try to download it on your own system.<a href="https://neo4j.com/download-center/" target="_blank" rel="noopener">Download Center</a> .(I am using Win10 and for learning usage, download Neo4j Community Edition 3.5.5). After download the starting file, let us try to start the server next.</p>
<h3 id="1-1-start-the-server"><a href="#1-1-start-the-server" class="headerlink" title="1.1 start the server"></a>1.1 start the server</h3><p>open an console and cd to your the install directory of neo4j. run the following command<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$  <span class="built_in">cd</span> &lt;your the install directory of neo4j&gt;</span><br><span class="line">$  bin\neo4j console</span><br></pre></td></tr></table></figure></p>
<p>you will get<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">INFO  ======== Neo4j 3.5.5 ========</span><br><span class="line">INFO  Starting...</span><br><span class="line">INFO  Bolt enabled on 127.0.0.1:7687.</span><br><span class="line">INFO  Started.</span><br><span class="line">Remote interface available at http://localhost:7474/</span><br></pre></td></tr></table></figure></p>
<p>then, goes to your browser and enter <a href="http://localhost:7474/" target="_blank" rel="noopener">http://localhost:7474/</a>. you will see the following web interface.</p>
<div><br>  <img src="/images/neo4j_intro_1.png" alt="Smiley face" width="50%" height="50%"><br>  <div class="text" style="text-align:center;font-size:10px"> Figure 1.1</div><br></div>


<h3 id="1-2-Authenticated-connection-to-the-database"><a href="#1-2-Authenticated-connection-to-the-database" class="headerlink" title="1.2 Authenticated connection to the database."></a>1.2 Authenticated connection to the database.</h3><p>Connect using the default username ‘neo4j’ with default password ‘neo4j’. It will leading to a instruction for you to set your own password for conection.</p>
<p>Now we are done.</p>
<div><br>  <img src="/images/neo4j_intro_2.png" alt="Smiley face" width="50%" height="50%"><br>  <div class="text" style="text-align:center;font-size:10px"> Figure 1.2</div><br></div>


<h2 id="2-Neo4j-Data-Model-amp-Architecture"><a href="#2-Neo4j-Data-Model-amp-Architecture" class="headerlink" title="2. Neo4j: Data Model &amp; Architecture"></a>2. Neo4j: Data Model &amp; Architecture</h2><p>Neo4j uses Native Graph Processing Engineer(GPE) to store the graph. To be specific, data are stored in the form of <strong><em>Nodes</em></strong> and properties related to that data are stored as <strong><em>key-value pairs</em></strong>, where Key is the property name and value is property value. For example, if I have one worker named Kitty and has some properties like, Id, gender ,department etc. So the node looks like the following:</p>
<div><br>  <img src="/images/neo4j_intro_3.png" alt="Smiley face" width="50%" height="50%"><br>  <div class="text" style="text-align:center;font-size:10px"> Data in Neo4j</div><br></div>

<p>Here, the node has a <strong><em>label</em></strong> called worker. As we known, each work is employee of one company. So, an edge  describes the relationship between labels.</p>
<div><br>  <img src="/images/neo4j_intro_4.png" alt="Smiley face" width="50%" height="50%"><br>  <div class="text" style="text-align:center;font-size:10px">relationship between labels</div><br></div>

<p>In order to do some manipulations on the database, let us first know about the data type supported in  Cypher Query Language (CQL).</p>
<h2 id="2-Cypher-Query-Language-CQL"><a href="#2-Cypher-Query-Language-CQL" class="headerlink" title="2. Cypher Query Language (CQL)."></a>2. Cypher Query Language (CQL).</h2><h3 id="2-1-Creating-Single-and-Multiple-Nodes-with-label"><a href="#2-1-Creating-Single-and-Multiple-Nodes-with-label" class="headerlink" title="2.1 Creating Single and Multiple Nodes with label"></a>2.1 Creating Single and Multiple Nodes with label</h3><p>Syntax:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ Create (Node_Name_1),(Node_Name_2),...</span><br></pre></td></tr></table></figure></p>
<p>Example<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ Create (Student),(School),(Subject)</span><br></pre></td></tr></table></figure></p>
<p>When we creating a node, we could add labels to that node, the syntax is :<br>Syntax:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ Create (Node_Name:Node_label)</span><br></pre></td></tr></table></figure></p>
<p>Example<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ Create (Kitty:Worker)</span><br></pre></td></tr></table></figure></p>
<p>To view all the nodes we have created before, using match clause without any conditions to get all results<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ MATCH (n) <span class="built_in">return</span> n</span><br></pre></td></tr></table></figure></p>
<p>We can see all the nodes created before, notice that, each node in the graph has its own id, and neo4j automatically generated id for each node.</p>
<div><br>  <img src="/images/neo4j_intro_5.png" alt="Smiley face" width="50%" height="50%"><br>  <div class="text" style="text-align:center;font-size:10px"> Data in Neo4j</div><br></div>

<p>Each node can have not only one labels, but also have  multiple labels.</p>
<p>Syntax:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ Create (Node_Name:Node_label_1:Node_label_2:Node_label_3:...)</span><br></pre></td></tr></table></figure></p>
<p>Example<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ Create (John:Teacher:Student:Professor)</span><br></pre></td></tr></table></figure></p>
<h3 id="2-2-Creating-Nodes-with-properties"><a href="#2-2-Creating-Nodes-with-properties" class="headerlink" title="2.2 Creating Nodes with properties"></a>2.2 Creating Nodes with properties</h3><p>As above discussion, nodes are actually key-value pairs,<br>Syntax:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ Create (Node_Name:Node_label&#123;&lt;key&gt;:&lt;value&gt;, &lt;key&gt;:&lt;value&gt;, ...&#125;)</span><br></pre></td></tr></table></figure></p>
<p>Example<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ Create (Kitty:Worker&#123;Gender:<span class="string">"Female"</span>, Department:<span class="string">"IT service"</span>&#125;)</span><br></pre></td></tr></table></figure></p>
<p>After run the MATCH CLAUSE, we could see the result.</p>
<div><br>  <img src="/images/neo4j_intro_6.png" alt="Smiley face" width="50%" height="50%"><br></div>

<h3 id="2-3-Creating-Nodes-with-properties"><a href="#2-3-Creating-Nodes-with-properties" class="headerlink" title="2.3 Creating Nodes with properties"></a>2.3 Creating Nodes with properties</h3><p>Before we establishing relationship between different nodes, let’s look at how to use where clause.<br>Syntax:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ MATCH(node:Node_label) WHERE node.property=<span class="string">"some_value"</span> RETURN node;</span><br></pre></td></tr></table></figure></p>
<p>Example : find all the female employees.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ MATCH (worker:Worker) WHERE worker.Gender = <span class="string">"Female"</span> RETURN worker;</span><br></pre></td></tr></table></figure></p>
<h3 id="2-4-Create-Relations-between-nodes"><a href="#2-4-Create-Relations-between-nodes" class="headerlink" title="2.4 Create Relations between nodes."></a>2.4 Create Relations between nodes.</h3><p>Syntax: Create nodes and creating relationships between them<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE (node1),(node2),(node3),(node1)-[r:Relation1]-&gt; (node2),(node2) -[r:Relation1]-&gt; (node3)</span><br></pre></td></tr></table></figure></p>
<p>Syntax : Select existing nodes and creating relationships between them.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MATCH(a:Node_label),(b:Node_label) WHERE a.ID = ??? AND b.ID=??? CREATE (b)-[r:R] -&gt; (a)</span><br></pre></td></tr></table></figure></p>
<p>Example:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CREATE(Tony:Software_Engineer&#123;name: <span class="string">"Tony"</span>, Gender: <span class="string">"Male"</span>, Department: <span class="string">"IT Dev"</span>, Age: 35&#125;),</span><br><span class="line">(IBM:Company&#123;name:<span class="string">"IBM"</span>&#125;), (Tony)-[r:Is_Employee_Of]-&gt;(IBM)  RETURN Tony, IBM</span><br></pre></td></tr></table></figure></p>
<div><br>  <img src="/images/neo4j_intro_7.png" alt="Smiley face" width="50%" height="50%"><br></div>

<p>Example: Create relationships between existing nodes.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MATCH(software_eigneer:Software_Engineer),(company:Company) WHERE software_eigneer.name = <span class="string">"Tony"</span> AND company.name=<span class="string">"IBM"</span> CREATE (company)-[relation:Hires] -&gt; (software_eigneer) RETURN software_eigneer, company</span><br></pre></td></tr></table></figure></p>
<p>Results:Java</p>
<div><br>  <img src="/images/neo4j_intro_8.png" alt="Smiley face" width="50%" height="50%"><br></div>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/05/08/DecoratorPattern/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Liang Tan">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/profile_photo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Liang Tan's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/05/08/DecoratorPattern/" class="post-title-link" itemprop="url">Design-Pattern -- Decorator Pattern</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-05-08 07:40:07" itemprop="dateCreated datePublished" datetime="2019-05-08T07:40:07-06:00">2019-05-08</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-05-09 17:35:46" itemprop="dateModified" datetime="2019-05-09T17:35:46-06:00">2019-05-09</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="1-Definition"><a href="#1-Definition" class="headerlink" title="1. Definition:"></a>1. Definition:</h2><p>&emsp; Let us first look at the strict definition of Decorator Pattern,  </p>
<p><blockquote style="text-align:justify;background-color: #ccfff5">&emsp;<strong>Decorator Pattern attaches additional responsibilities to one Object dynamically, without affecting the behaviour of other objects from the same class. Decorator provides a flexible alternative to sub-classes for extending functionalities.  (<a href="https://en.wikipedia.org/wiki/Decorator_pattern" target="_blank" rel="noopener">Wiki_Link_For_More_Info</a>) </strong></blockquote><br></p>
<p>Detail of the definition:</p>
<ul>
<li><strong>dynamically</strong> : The meaning at dynamically means that those attached responsibilities are not <strong>*hard-coded</strong> in to the object class <strong><em>at compile time</em></strong>. Instead, these responsibilities are added <strong><em>at runtime time</em></strong> by different Decorator. At the same time, one type of object could have multiple types of decorators, so a client can choose any one or any combination of them to decorate the object at runtime.</li>
<li><strong>flexible alternative</strong>: decorator pattern using <strong><em>Composition</em></strong> rather than <strong><em>Inheritance</em></strong>. Since inheritance is not used, the original class functionalities will not be changed.</li>
</ul>
<p>Before going to the UML of decorator pattern, let us look at the design principles it bases on.</p>
<ol>
<li><p><strong>Open Close Principle</strong>: Software entities like classes, modules and functions should be <strong><em>open for extension</em></strong> but <strong><em>closed for modifications</em></strong>. When the requirements have been changed for one class, it is not recommended to go into that class and change the code, instead, using abstract class and concrete classes for implementing their behaviour. In different scenario, using different concrete classes. In decorator pattern, Component are usually interface or abstract class.</p>
</li>
<li><p><strong>Single responsibilities Principle</strong>: A class should have <strong><em>only one reason</em></strong> to change. This means that  if we have 2 reasons to change for a class, we have to split the functionality in two classes. In decorator pattern, each concrete decorator has only changed one responsibility of the original class. In order to get multiple responsibilities changed, using composition of decorators.</p>
</li>
</ol>
<p>Now, let us draw a picture to see what a decorator and component relation actually is.</p>
<div><br>  <img src="/images/decorator_1.png" alt="Smiley face" width="50%" height="50%"><br>  <div class="text" style="text-align:center;font-size:10px"> decorator and Component relation</div><br></div>

<p>Notice</p>
<ol>
<li>Decorator <strong><em>has-a</em></strong> component of that type. Decorator is a wrapper of component. It has a reference or pointer to the component object so that it can invoke the method defines in that component.</li>
<li>Meanwhile, Decorator <strong><em>is-a</em></strong> component. Decorator itself must also be a component of that type. So, a decorator can be viewed as a component and wrapped by another Decorator. (Very similar to recursion.)</li>
</ol>
<h2 id="2-General-UML"><a href="#2-General-UML" class="headerlink" title="2. General UML:"></a>2. General UML:</h2><div><br>  <img src="/images/decorator_2.jpg" alt="Smiley face" width="50%" height="50%"><br>  <div class="text" style="text-align:center;font-size:10px"> UML for decorator pattern</div><br></div>

<p>Here, I implement the UML as an example with slightly differences<br>interface Component:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">method</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>Concrete Component:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Component</span> <span class="keyword">implements</span> <span class="title">IComponent</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">operation</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"I am a base method in concrete Component"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>Abstract Class decorator:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Decorator</span> <span class="keyword">implements</span> <span class="title">IComponent</span></span>&#123;<span class="comment">// it is a component</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> IComponent component;<span class="comment">// it has-a component</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Decorator</span><span class="params">(IComponent component)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.component = component;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">operation</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        component.operation();<span class="comment">// invoke base method</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>Concrete decorator A:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DecoratorA</span> <span class="keyword">extends</span> <span class="title">Decorator</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">DecoratorA</span><span class="params">(IComponent component)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(component);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">preOperation</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"this is a pre-operation defined in decoratorA"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * Add a pre-operation before base Operation</span></span><br><span class="line"><span class="comment">     * */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">operation</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.preOperation();</span><br><span class="line">        <span class="keyword">super</span>.operation();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>Concrete decorator B:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DecoratorB</span> <span class="keyword">extends</span> <span class="title">Decorator</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//decorator can have new properties and method.</span></span><br><span class="line">    <span class="keyword">private</span> String newSate = <span class="string">"I am a new State"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">DecoratorB</span><span class="params">(IComponent component)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(component);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">postOperation</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"this is a post-operation defined in decoratorB"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">operation</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.operation();</span><br><span class="line">        <span class="keyword">this</span>.postOperation();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setNewSate</span><span class="params">(String newSate)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.newSate = newSate;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getNewSate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> newSate;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>Test Main_function:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        IComponent component = <span class="keyword">new</span> Component();</span><br><span class="line">        component.operation();</span><br><span class="line">        System.out.println(<span class="string">"------------------------------"</span>);</span><br><span class="line"></span><br><span class="line">        IComponent concreteDecortorA = <span class="keyword">new</span> DecoratorA(component);</span><br><span class="line">        concreteDecortorA.operation();<span class="comment">// operation after decorating by A</span></span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">"------------------------------"</span>);</span><br><span class="line">        IComponent concrteDecortorB = <span class="keyword">new</span> DecoratorB(component);</span><br><span class="line">        concrteDecortorB.operation();<span class="comment">// operation after decorating by B</span></span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">"------------------------------"</span>);</span><br><span class="line">        <span class="comment">// decorator of decorator, by passing concreteDecortorA as parameter of decoratorB</span></span><br><span class="line">        IComponent compositeDecortor = <span class="keyword">new</span> DecoratorB(concreteDecortorA);</span><br><span class="line">        <span class="comment">// first invoke operation defined by concreteDecortorA, concreteDecortorA will invoke the operation defined by the</span></span><br><span class="line">        <span class="comment">// base component</span></span><br><span class="line">        compositeDecortor.operation();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>Output:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">I am a base method in concrete Component</span><br><span class="line">------------------------------</span><br><span class="line">this is a pre-operation defined in decoratorA</span><br><span class="line">I am a base method in concrete Component</span><br><span class="line">------------------------------</span><br><span class="line">I am a base method in concrete Component</span><br><span class="line">this is a post-operation defined in decoratorB</span><br><span class="line">------------------------------</span><br><span class="line">this is a pre-operation defined in decoratorA</span><br><span class="line">I am a base method in concrete Component</span><br><span class="line">this is a post-operation defined in decoratorB</span><br></pre></td></tr></table></figure></p>
<p>Comments:<br>For composite decorator, it takes another decorator as a component, and when it invoke the operation() method, it will invoke the operation defined by the component(which is also a decorator) , and that component recursively invoke the base component(which is actually a real component), it invokes the base method ,and returns the result to its decorator, and that decorator returns the result to the composite decorator.</p>
<h2 id="3-Java-IO-InputStream"><a href="#3-Java-IO-InputStream" class="headerlink" title="3. Java IO - InputStream:"></a>3. Java IO - InputStream:</h2><p>java.io.inputStream uses the decorator Pattern. From the book <a href="https://www.amazon.com/dp/0596007124/?tag=stackoverfl08-20" target="_blank" rel="noopener">Head First Design Patterns</a>,we can see how they use decorator Pattern in java to add functionalities for reading data from files.</p>
<div><br>  <img src="/images/decorator_3.jpg" alt="Smiley face" width="50%" height="50%"><br>  <div class="text" style="text-align:center;font-size:10px"> how decorator pattern used in java.io</div><br></div>

<div><br>  <img src="/images/decorator_4.jpg" alt="Smiley face" width="50%" height="50%"><br>  <div class="text" style="text-align:center;font-size:10px"> java.io.inputStream hierarchy </div><br></div>

<p>The usage of decorator pattern in java.io also points to the <em>drawback</em> of decorator pattern. There are <em>so many decorators implementation classes</em>. It can be confusing for clients who call those decorator-API. It is somehow hard when those clients can not tell the difference between each decorators. However, once they know, they can combine different decorators for their own applications.</p>
<p>Now, let us create a own type of Input Stream and test it.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UpperCaseInputStream</span> <span class="keyword">extends</span> <span class="title">FileInputStream</span> </span>&#123;<span class="comment">// is-a</span></span><br><span class="line">    <span class="comment">// Constructors which matches the super class FileInputStream</span></span><br><span class="line">    <span class="keyword">private</span> FileInputStream fileInputStream; <span class="comment">//has-a</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">UpperCaseInputStream</span><span class="params">(String name,FileInputStream fileInputStream)</span> <span class="keyword">throws</span> FileNotFoundException </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(name);</span><br><span class="line">        <span class="keyword">this</span>.fileInputStream = fileInputStream;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">UpperCaseInputStream</span><span class="params">(File file,FileInputStream fileInputStream)</span> <span class="keyword">throws</span> FileNotFoundException </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(file);</span><br><span class="line">        <span class="keyword">this</span>.fileInputStream = fileInputStream;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">UpperCaseInputStream</span><span class="params">(FileDescriptor fdObj,FileInputStream fileInputStream)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(fdObj);</span><br><span class="line">        <span class="keyword">this</span>.fileInputStream = fileInputStream;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> nextByte = <span class="keyword">super</span>.read();</span><br><span class="line">        <span class="keyword">if</span> (nextByte == -<span class="number">1</span>) <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> Character.toUpperCase((<span class="keyword">char</span>) (nextByte));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">(<span class="keyword">byte</span>[] b)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> totalBytes = <span class="keyword">super</span>.read(b);</span><br><span class="line">        <span class="keyword">if</span> (totalBytes == -<span class="number">1</span>) <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">        convertToUppercase(b, <span class="number">0</span>, totalBytes);</span><br><span class="line">        <span class="keyword">return</span> totalBytes;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">(<span class="keyword">byte</span>[] b, <span class="keyword">int</span> off, <span class="keyword">int</span> len)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> totalBytes = <span class="keyword">super</span>.read(b, off, len);</span><br><span class="line">        <span class="keyword">if</span> (totalBytes == -<span class="number">1</span>) <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">        <span class="comment">// convert all the character in byte array to uppercase letter</span></span><br><span class="line">        convertToUppercase(b, off, off + totalBytes);</span><br><span class="line">        <span class="keyword">return</span> totalBytes;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">convertToUppercase</span><span class="params">(<span class="keyword">byte</span>[] b, <span class="keyword">int</span> start, <span class="keyword">int</span> end)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> idx = start; idx &lt; end; idx++) &#123;</span><br><span class="line">            b[idx] = (<span class="keyword">byte</span>) Character.toUpperCase((<span class="keyword">char</span>) (b[idx]));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Test our UpperCaseInputStream:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UpperCaseInputStreamTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String filePath = <span class="string">"data/text_file.txt"</span>;</span><br><span class="line">        FileInputStream fileinputStream = <span class="keyword">null</span>;</span><br><span class="line">        UpperCaseInputStream upperCaseInputStream = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 1. Create a component with one base class: FileInputStream</span></span><br><span class="line">            fileinputStream = <span class="keyword">new</span> FileInputStream(filePath);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//2. Create our customized decorator with the base component</span></span><br><span class="line">            upperCaseInputStream = <span class="keyword">new</span> UpperCaseInputStream(filePath, fileinputStream);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3.1Test read once at a time</span></span><br><span class="line">        <span class="comment">/*try &#123;</span></span><br><span class="line"><span class="comment">            do&#123;</span></span><br><span class="line"><span class="comment">                System.out.print((char) upperCaseInputStream.read());</span></span><br><span class="line"><span class="comment">            &#125;while (upperCaseInputStream.read() != -1);</span></span><br><span class="line"><span class="comment">        &#125; catch (IOException e) &#123;</span></span><br><span class="line"><span class="comment">            e.printStackTrace();</span></span><br><span class="line"><span class="comment">        &#125;*/</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//3.2 Test read into byte array buffer</span></span><br><span class="line">        <span class="keyword">byte</span>[] buf = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">        <span class="keyword">int</span> length;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">while</span> ((length = upperCaseInputStream.read(buf)) != -<span class="number">1</span>) &#123;</span><br><span class="line">                System.out.println(<span class="keyword">new</span> String(buf, <span class="number">0</span>, length));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//4. release the resources</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            upperCaseInputStream.close();</span><br><span class="line">            fileinputStream.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>OutPut:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">BCDEFGHIJKLMN</span><br><span class="line">GKIERERU</span><br></pre></td></tr></table></figure></p>
<p>text_file.txt :<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">bcdefghijklmn</span><br><span class="line">GKiereru</span><br></pre></td></tr></table></figure></p>
<p>Hence, our UpperCaseInputStream meets the expectation.</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/05/07/ObserverPattern/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Liang Tan">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/profile_photo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Liang Tan's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/05/07/ObserverPattern/" class="post-title-link" itemprop="url">Design-Pattern -- Observer Pattern</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-05-07 17:14:18" itemprop="dateCreated datePublished" datetime="2019-05-07T17:14:18-06:00">2019-05-07</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-05-09 17:36:13" itemprop="dateModified" datetime="2019-05-09T17:36:13-06:00">2019-05-09</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="1-Definition"><a href="#1-Definition" class="headerlink" title="1. Definition:"></a>1. Definition:</h2><p>&emsp; Let us first look at the strict definition of Observer Pattern,  </p>
<p><blockquote style="text-align:justify;background-color: #ccfff5">&emsp;<strong>Observer Pattern defines a One-to-many dependencies between objects. Once the Object change state, all of their dependencies are notified and changed automatically.</strong></blockquote> <br></p>
<p>&emsp; There are several terminology used in the Observer Pattern , which are as follows:</p>
<ul>
<li><p><strong>Observable</strong> : This object has some attributes which may change frequently. It is also known as Subject.</p>
</li>
<li><p><strong>Observer</strong>: The object which has to receive those frequently modified attributes from the Observable objects. They are also known as Object.</p>
</li>
<li><p><strong>One-to-many dependencies</strong>: There is only one Observable objects and many Observers related to it. This means that the Observable object has a collection of Observers who subscribe it.</p>
</li>
</ul>
<p>The following figure shows their relationship.</p>
<div><br>  <img src="/images/observer_1.jpg" alt="Smiley face" width="50%" height="50%"><br>  <div class="text" style="text-align:center;font-size:10px">1 - n relationship </div><br></div>

<p>Observer Pattern usually used in the scenario that one object are active to have some properties changed quite often while at the same time, some objects wants to know some information from that object as soon as possible. For example, one temperature sensor versus some distributed diplays who show the temperature in differnt way, one writer who post articles versus several readers who subscribe him or her.</p>
<h2 id="2-UML"><a href="#2-UML" class="headerlink" title="2. UML:"></a>2. UML:</h2><p>&emsp;Now, let us see the general UML diagram for Observer pattern.</p>
<div><br>  <img src="/images/observer_2.jpg" alt="Smiley face" width="50%" height="50%"><br>  <div class="text" style="text-align:center;font-size:10px"> UML diagram</div><br></div>

<p>For observable interface it defines three behaviours of observable object.</p>
<ol>
<li>add method by passing an object who implements observer interface;</li>
<li>delete method by passing an object who implements observer interface;</li>
<li>nofityAll method: it iterates all observers and call the update method defined in each observer.</li>
</ol>
<p>For the Concrete Observable who implements the interface, it need to have two properties, which are</p>
<ol>
<li>State state : the frequently changed state</li>
<li>A Collection of Observers who want to get the state from the Observable, it can be either list, set or dictionary depending on different application for insertion, deletion and iteration of observers.</li>
</ol>
<p>Two important things to be understand about Observer Pattern.</p>
<ol>
<li><p><strong>The constructer of Concrete Observer should have one argument which is the reference of the observable it want to subscribe. Not only Observable should have a set of observers, but also each observer should know the follower so that they can invoke the getState() method to update the state.</strong></p>
</li>
<li><p><strong>The arguments type in constructors and methods should be in interface type rather than entities cos the <em>interface design principle</em> and <em>least knowledge design principle</em>.We could casting them to entity type if necessary in some methods.</strong></p>
</li>
</ol>
<h2 id="3-Example-and-Implementation-in-Java"><a href="#3-Example-and-Implementation-in-Java" class="headerlink" title="3. Example and Implementation in Java:"></a>3. Example and Implementation in Java:</h2><p>Now, let us see an Example and implement it by using java.</p>
<p>Example:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">There is a Publishing House who can publish new books.</span><br><span class="line">Meanwhile, here are readers who can follow and unfollow this publishing house.</span><br><span class="line">Once the publish house publish a new book, it will broadcast notification to all its followers.</span><br><span class="line">Write program to mimic the process.</span><br></pre></td></tr></table></figure></p>
<p>First, implement two interfaces.<br>IObservable:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IObservable</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span>  <span class="title">addObserver</span><span class="params">(IObserver observer)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span>  <span class="title">removeObserver</span><span class="params">(IObserver observer)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span>  <span class="title">notifyAllObservers</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>IObserver:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IObserver</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>Then, implements Publisher and Reader as concrete implementation classes.<br>Observable: Publisher<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.HashSet;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Publisher</span> <span class="keyword">implements</span> <span class="title">IObservable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String publisherName;</span><br><span class="line">    <span class="keyword">private</span> Set&lt;IObserver&gt; readers; <span class="comment">// set of observers which are in type of Reader class</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;String&gt; books ; <span class="comment">// list of new published book</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//no-args constructors</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Publisher</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">        readers = <span class="keyword">new</span> HashSet&lt;&gt;();</span><br><span class="line">        books =  <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Publisher</span><span class="params">(String publisherName)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.publisherName = publisherName;</span><br><span class="line">        readers = <span class="keyword">new</span> HashSet&lt;&gt;();</span><br><span class="line">        books =  <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">publishNewBook</span><span class="params">(String bookName)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(bookName == <span class="keyword">null</span>) <span class="keyword">return</span>;</span><br><span class="line">        books.add(bookName);</span><br><span class="line">        <span class="keyword">this</span>.notifyAllObservers();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addObserver</span><span class="params">(IObserver observer)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// if the observer is null or if it is not an instance of Reader, return;</span></span><br><span class="line">        <span class="keyword">if</span> (observer == <span class="keyword">null</span> || !(observer <span class="keyword">instanceof</span> Reader)) <span class="keyword">return</span>;</span><br><span class="line">        <span class="comment">// if it already subscribed the publisher</span></span><br><span class="line">        <span class="keyword">if</span> (readers.contains(observer)) <span class="keyword">return</span>;</span><br><span class="line">        readers.add(observer);</span><br><span class="line"></span><br><span class="line">        Reader newReader = (Reader)observer; <span class="comment">// cast to Reader object</span></span><br><span class="line">        System.out.println(newReader.getReaderName()+<span class="string">" has subscribed "</span> + <span class="keyword">this</span>.getPublisherName());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">removeObserver</span><span class="params">(IObserver observer)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(readers.contains(observer))&#123;</span><br><span class="line">            readers.remove(observer);</span><br><span class="line">            Reader reader = (Reader)observer;</span><br><span class="line">            System.out.println(reader.getReaderName()+<span class="string">" has unfollowed "</span> + <span class="keyword">this</span>.getPublisherName());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">notifyAllObservers</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// iterate all observers and notify them.</span></span><br><span class="line">        <span class="keyword">for</span>(IObserver reader: readers)&#123;</span><br><span class="line">            reader.update();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Getters</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getLatestPublishedBookName</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> books.get(books.size()-<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getPublisherName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> publisherName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPublisherName</span><span class="params">(String publisherName)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.publisherName = publisherName;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>Observer: Reader<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Reader</span> <span class="keyword">implements</span> <span class="title">IObserver</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String readerName;</span><br><span class="line">    <span class="keyword">private</span> Publisher publisher;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Reader</span><span class="params">(String name, Publisher publisher)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.readerName = name;</span><br><span class="line">        <span class="keyword">this</span>.publisher = publisher;<span class="comment">//dependencies injection</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="keyword">this</span>.readerName + <span class="string">" Knows that the publisher published a new book, called "</span> + <span class="keyword">this</span>.publisher.getLatestPublishedBookName());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getReaderName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> readerName;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>Finally, write the main function to mimic the process.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ObserverPatternTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line">        Publisher  publisher = <span class="keyword">new</span> Publisher(<span class="string">"BOOK STORE 1"</span>);</span><br><span class="line">        Reader tom = <span class="keyword">new</span> Reader(<span class="string">"Tom"</span>,publisher);</span><br><span class="line">        Reader ben = <span class="keyword">new</span> Reader(<span class="string">"Ben"</span>,publisher);</span><br><span class="line">        Reader alice = <span class="keyword">new</span> Reader(<span class="string">"Alice"</span>,publisher);</span><br><span class="line"></span><br><span class="line">        publisher.addObserver(tom);</span><br><span class="line">        publisher.addObserver(ben);</span><br><span class="line">        publisher.addObserver(alice);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        publisher.publishNewBook(<span class="string">"Introduction to Design Pattern "</span>);</span><br><span class="line">        System.out.println(<span class="string">"A few months later"</span>);</span><br><span class="line"></span><br><span class="line">        Thread.currentThread().sleep(<span class="number">1000</span>);</span><br><span class="line">        Reader mike = <span class="keyword">new</span> Reader(<span class="string">"Mike"</span>,publisher);</span><br><span class="line">        publisher.addObserver(mike); <span class="comment">// new subscriber</span></span><br><span class="line">        publisher.removeObserver(tom);</span><br><span class="line">        Thread.currentThread().sleep(<span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line">        publisher.publishNewBook(<span class="string">"Algorithms and Data Structure"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Output:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Tom has subscribed BOOK STORE 1</span><br><span class="line">Ben has subscribed BOOK STORE 1</span><br><span class="line">Alice has subscribed BOOK STORE 1</span><br><span class="line"></span><br><span class="line">Ben Knows that the publisher published a new book, called Introduction to Design Pattern</span><br><span class="line">Tom Knows that the publisher published a new book, called Introduction to Design Pattern</span><br><span class="line">Alice Knows that the publisher published a new book, called Introduction to Design Pattern</span><br><span class="line"></span><br><span class="line">A few months later</span><br><span class="line">Mike has subscribed BOOK STORE 1</span><br><span class="line">Tom has unfollowed BOOK STORE 1</span><br><span class="line"></span><br><span class="line">Ben Knows that the publisher published a new book, called Algorithms and Data Structure</span><br><span class="line">Mike Knows that the publisher published a new book, called Algorithms and Data Structure</span><br><span class="line">Alice Knows that the publisher published a new book, called Algorithms and Data Structure</span><br></pre></td></tr></table></figure></p>
<p>We can view the automatically generated UML diagram by IntelliJ IDEA.</p>
<div><br>  <img src="/images/observer_3.jpg" alt="Smiley face" width="50%" height="50%"><br>  <div class="text" style="text-align:center;font-size:10px"> UML diagram by IntelliJ</div><br></div>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/05/04/hello-world/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Liang Tan">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/profile_photo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Liang Tan's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/05/04/hello-world/" class="post-title-link" itemprop="url">Hello World</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-05-04 11:06:34" itemprop="dateCreated datePublished" datetime="2019-05-04T11:06:34-06:00">2019-05-04</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-05-09 17:36:15" itemprop="dateModified" datetime="2019-05-09T17:36:15-06:00">2019-05-09</time>
              
            
          </span>

          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><p>DataBase</p>
<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="noopener">Deployment</a></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  


          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <div class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/profile_photo.jpg" alt="Liang Tan">
            
              <p class="site-author-name" itemprop="name">Liang Tan</p>
              <div class="site-description motion-element" itemprop="description"></div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives">
                
                    <span class="site-state-item-count">8</span>
                    <span class="site-state-item-name">posts</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  
                    
                      <a href="/categories/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">5</span>
                    <span class="site-state-item-name">categories</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                      <a href="/tags/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">32</span>
                    <span class="site-state-item-name">tags</span>
                  </a>
                </div>
              
            </nav>
          

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          

          

          

          
          

          
            
          
          

        </div>
      </div>

      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Liang Tan</span>

  

  
</div>


  <div class="powered-by">Powered by <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> v3.8.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> v7.1.1</div>




        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="post-meta-item-icon">
      <i class="fa fa-user"></i>
    </span>
    <span class="site-uv" title="Total Visitors">
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
    </span>
  

  
    <span class="post-meta-divider">|</span>
  

  
    <span class="post-meta-item-icon">
      <i class="fa fa-eye"></i>
    </span>
    <span class="site-pv" title="Total Views">
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
    </span>
  
</div>









        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/utils.js?v=7.1.1"></script>

  <script src="/js/motion.js?v=7.1.1"></script>



  
  


  <script src="/js/affix.js?v=7.1.1"></script>

  <script src="/js/schemes/pisces.js?v=7.1.1"></script>



  

  


  <script src="/js/next-boot.js?v=7.1.1"></script>


  

  

  

  



  




  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
  
      <script type="text/javascript" src="/js/src/clicklove.js"></script>
  
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":null,"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"react":{"opacity":0.7}});</script></body>
</html>
